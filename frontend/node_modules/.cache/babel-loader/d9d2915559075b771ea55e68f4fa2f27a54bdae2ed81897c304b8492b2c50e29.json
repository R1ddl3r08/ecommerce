{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ecommerce\\\\frontend\\\\src\\\\components\\\\CartModal.js\";\nimport React, { Component, forwardRef, useRef, useImperativeHandle, createRef, useContext } from 'react';\nimport { createPortal } from 'react-dom';\nimport { gql, useMutation } from '@apollo/client';\nimport { ToastContainer, toast } from 'react-toastify';\nimport Cart from './Cart';\nimport { CartContext } from '../store/shopping-cart-context';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CREATE_ORDER = gql`\n  mutation CreateOrder($input: OrderInput!) {\n    createOrder(input: $input) {\n      id\n      total\n      items {\n        id\n        product_id\n        quantity\n        price\n        attributes {\n          id\n          attribute_id\n        }\n      }\n    }\n  }\n`;\nclass CartModal extends Component {\n  constructor(props) {\n    super(props);\n    this.open = () => {\n      this.setState({\n        isOpen: true\n      });\n    };\n    this.close = () => {\n      this.setState({\n        isOpen: false\n      });\n    };\n    this.handlePlaceOrder = () => {\n      const {\n        items,\n        clearCart\n      } = this.context;\n      const orderInput = {\n        total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\n        items: items.map(item => ({\n          product_id: item.id,\n          quantity: item.quantity,\n          price: item.price.amount,\n          attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\n            attribute_id: value\n          })) : []\n        }))\n      };\n      this.props.createOrder({\n        variables: {\n          input: orderInput\n        }\n      });\n    };\n    this.modalRef = /*#__PURE__*/createRef();\n    this.state = {\n      isOpen: false\n    };\n  }\n  render() {\n    const {\n      isOpen\n    } = this.state;\n    const {\n      items\n    } = this.context;\n    const {\n      loading,\n      error\n    } = this.props;\n    if (!isOpen) {\n      return null;\n    }\n    return /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-backdrop\",\n        onClick: this.close\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        ref: this.modalRef,\n        children: [/*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: items.length < 1 || loading,\n            className: \"place-order-button\",\n            onClick: this.handlePlaceOrder,\n            children: loading ? 'Placing order...' : 'Place order'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error\",\n            children: [\"Error placing order: \", error.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true), document.getElementById('modal-root'));\n  }\n}\nCartModal.contextType = CartContext;\nexport default CartModal;","map":{"version":3,"names":["React","Component","forwardRef","useRef","useImperativeHandle","createRef","useContext","createPortal","gql","useMutation","ToastContainer","toast","Cart","CartContext","jsxDEV","_jsxDEV","Fragment","_Fragment","CREATE_ORDER","CartModal","constructor","props","open","setState","isOpen","close","handlePlaceOrder","items","clearCart","context","orderInput","total","reduce","acc","item","price","amount","quantity","map","product_id","id","attributes","selectedAttributes","Object","entries","key","value","attribute_id","createOrder","variables","input","modalRef","state","render","loading","error","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","disabled","length","message","document","getElementById","contextType"],"sources":["C:/xampp/htdocs/ecommerce/frontend/src/components/CartModal.js"],"sourcesContent":["import React, { Component, forwardRef, useRef, useImperativeHandle, createRef, useContext } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { gql, useMutation } from '@apollo/client';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport Cart from './Cart';\r\nimport { CartContext } from '../store/shopping-cart-context';\r\n\r\nconst CREATE_ORDER = gql`\r\n  mutation CreateOrder($input: OrderInput!) {\r\n    createOrder(input: $input) {\r\n      id\r\n      total\r\n      items {\r\n        id\r\n        product_id\r\n        quantity\r\n        price\r\n        attributes {\r\n          id\r\n          attribute_id\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CartModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.modalRef = createRef();\r\n    this.state = {\r\n      isOpen: false,\r\n    };\r\n  }\r\n\r\n  static contextType = CartContext;\r\n\r\n  open = () => {\r\n    this.setState({ isOpen: true });\r\n  };\r\n\r\n  close = () => {\r\n    this.setState({ isOpen: false });\r\n  };\r\n\r\n  handlePlaceOrder = () => {\r\n    const { items, clearCart } = this.context;\r\n    const orderInput = {\r\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\r\n      items: items.map(item => ({\r\n        product_id: item.id,\r\n        quantity: item.quantity,\r\n        price: item.price.amount,\r\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\r\n          attribute_id: value\r\n        })) : [],\r\n      })),\r\n    };\r\n\r\n    this.props.createOrder({ variables: { input: orderInput } });\r\n  };\r\n\r\n  render() {\r\n    const { isOpen } = this.state;\r\n    const { items } = this.context;\r\n    const { loading, error } = this.props;\r\n\r\n    if (!isOpen) {\r\n      return null;\r\n    }\r\n\r\n    return createPortal(\r\n      <>\r\n        <div className=\"modal-backdrop\" onClick={this.close} />\r\n        <div className=\"modal\" ref={this.modalRef}>\r\n          <Cart />\r\n          <div id=\"modal-actions\">\r\n            <button\r\n              disabled={items.length < 1 || loading}\r\n              className=\"place-order-button\"\r\n              onClick={this.handlePlaceOrder}\r\n            >\r\n              {loading ? 'Placing order...' : 'Place order'}\r\n            </button>\r\n            {error && <p className=\"error\">Error placing order: {error.message}</p>}\r\n          </div>\r\n        </div>\r\n      </>,\r\n      document.getElementById('modal-root')\r\n    );\r\n  }\r\n}\r\n\r\nexport default CartModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
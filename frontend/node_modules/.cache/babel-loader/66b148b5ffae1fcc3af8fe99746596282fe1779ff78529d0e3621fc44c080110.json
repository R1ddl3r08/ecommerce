{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ecommerce\\\\frontend\\\\src\\\\components\\\\CartModal.js\";\nimport React, { Component } from 'react';\nimport { createPortal } from 'react-dom';\nimport { gql, useMutation } from '@apollo/client';\nimport { ToastContainer, toast } from 'react-toastify';\nimport Cart from './Cart';\nimport { CartContext } from '../store/shopping-cart-context';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CREATE_ORDER = gql`\n  mutation CreateOrder($input: OrderInput!) {\n    createOrder(input: $input) {\n      id\n      total\n      items {\n        id\n        product_id\n        quantity\n        price\n        attributes {\n          id\n          attribute_id\n        }\n      }\n    }\n  }\n`;\nclass CartModal extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      loading: false,\n      error: null\n    };\n    this.modalRef = /*#__PURE__*/React.createRef();\n    this.handlePlaceOrder = this.handlePlaceOrder.bind(this);\n  }\n  handlePlaceOrder() {\n    const {\n      items,\n      clearCart\n    } = this.context;\n    const orderInput = {\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\n      items: items.map(item => ({\n        product_id: item.id,\n        quantity: item.quantity,\n        price: item.price.amount,\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\n          attribute_id: value\n        })) : []\n      }))\n    };\n    this.setState({\n      loading: true\n    });\n    this.props.client.mutate({\n      mutation: CREATE_ORDER,\n      variables: {\n        input: orderInput\n      },\n      onCompleted: data => {\n        console.log('Order created:', data);\n        clearCart();\n        this.setState({\n          loading: false,\n          isOpen: false\n        });\n        toast.success(\"Order created!\", {\n          position: \"top-center\",\n          autoClose: 3000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n      },\n      onError: error => {\n        console.error('Error placing order:', error);\n        this.setState({\n          loading: false,\n          error\n        });\n      }\n    });\n  }\n  openModal() {\n    this.setState({\n      isOpen: true\n    });\n  }\n  closeModal() {\n    this.setState({\n      isOpen: false\n    });\n  }\n  render() {\n    const {\n      items\n    } = this.context;\n    const {\n      isOpen,\n      loading,\n      error\n    } = this.state;\n    if (!isOpen) {\n      return null;\n    }\n    return /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-backdrop\",\n        onClick: () => this.closeModal()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        ref: this.modalRef,\n        children: [/*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: items.length < 1 || loading,\n            className: \"place-order-button\",\n            onClick: () => this.handlePlaceOrder(),\n            children: loading ? 'Placing order...' : 'Place order'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error\",\n            children: [\"Error placing order: \", error.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true), document.getElementById('modal-root'));\n  }\n}\nCartModal.contextType = CartContext;\nexport default CartModal;","map":{"version":3,"names":["React","Component","createPortal","gql","useMutation","ToastContainer","toast","Cart","CartContext","jsxDEV","_jsxDEV","Fragment","_Fragment","CREATE_ORDER","CartModal","constructor","props","state","isOpen","loading","error","modalRef","createRef","handlePlaceOrder","bind","items","clearCart","context","orderInput","total","reduce","acc","item","price","amount","quantity","map","product_id","id","attributes","selectedAttributes","Object","entries","key","value","attribute_id","setState","client","mutate","mutation","variables","input","onCompleted","data","console","log","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","onError","openModal","closeModal","render","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","disabled","length","message","document","getElementById","contextType"],"sources":["C:/xampp/htdocs/ecommerce/frontend/src/components/CartModal.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { gql, useMutation } from '@apollo/client';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport Cart from './Cart';\r\nimport { CartContext } from '../store/shopping-cart-context';\r\n\r\nconst CREATE_ORDER = gql`\r\n  mutation CreateOrder($input: OrderInput!) {\r\n    createOrder(input: $input) {\r\n      id\r\n      total\r\n      items {\r\n        id\r\n        product_id\r\n        quantity\r\n        price\r\n        attributes {\r\n          id\r\n          attribute_id\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CartModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isOpen: false,\r\n      loading: false,\r\n      error: null,\r\n    };\r\n    this.modalRef = React.createRef();\r\n    this.handlePlaceOrder = this.handlePlaceOrder.bind(this);\r\n  }\r\n\r\n  static contextType = CartContext;\r\n\r\n  handlePlaceOrder() {\r\n    const { items, clearCart } = this.context;\r\n\r\n    const orderInput = {\r\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\r\n      items: items.map(item => ({\r\n        product_id: item.id,\r\n        quantity: item.quantity,\r\n        price: item.price.amount,\r\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\r\n          attribute_id: value\r\n        })) : [],\r\n      })),\r\n    };\r\n\r\n    this.setState({ loading: true });\r\n  \r\n    this.props.client.mutate({\r\n      mutation: CREATE_ORDER,\r\n      variables: { input: orderInput },\r\n      onCompleted: (data) => {\r\n        console.log('Order created:', data);\r\n        clearCart();\r\n        this.setState({ loading: false, isOpen: false });\r\n        toast.success(\"Order created!\", {\r\n          position: \"top-center\",\r\n          autoClose: 3000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n        });\r\n      },\r\n      onError: (error) => {\r\n        console.error('Error placing order:', error);\r\n        this.setState({ loading: false, error });\r\n      }\r\n    });\r\n  }\r\n\r\n  openModal() {\r\n    this.setState({ isOpen: true });\r\n  }\r\n\r\n  closeModal() {\r\n    this.setState({ isOpen: false });\r\n  }\r\n\r\n  render() {\r\n    const { items } = this.context;\r\n    const { isOpen, loading, error } = this.state;\r\n\r\n    if (!isOpen) {\r\n      return null;\r\n    }\r\n\r\n    return createPortal(\r\n      <>\r\n        <div className=\"modal-backdrop\" onClick={() => this.closeModal()} />\r\n        <div className=\"modal\" ref={this.modalRef}>\r\n          <Cart />\r\n          <div id=\"modal-actions\">\r\n            <button\r\n              disabled={items.length < 1 || loading}\r\n              className=\"place-order-button\"\r\n              onClick={() => this.handlePlaceOrder()}\r\n            >\r\n              {loading ? 'Placing order...' : 'Place order'}\r\n            </button>\r\n            {error && <p className=\"error\">Error placing order: {error.message}</p>}\r\n          </div>\r\n        </div>\r\n      </>,\r\n      document.getElementById('modal-root')\r\n    );\r\n  }\r\n}\r\n\r\nexport default CartModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
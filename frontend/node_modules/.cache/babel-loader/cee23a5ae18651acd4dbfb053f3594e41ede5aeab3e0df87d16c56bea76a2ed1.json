{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ecommerce\\\\frontend\\\\src\\\\components\\\\CartModal.js\";\nimport React, { Component, forwardRef, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { gql } from '@apollo/client';\nimport { Query } from '@apollo/client/react/components';\nimport { ToastContainer, toast } from 'react-toastify';\nimport Cart from './Cart';\nimport { CartContext } from '../store/shopping-cart-context';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CREATE_ORDER = gql`\n  mutation CreateOrder($input: OrderInput!) {\n    createOrder(input: $input) {\n      id\n      total\n      items {\n        id\n        product_id\n        quantity\n        price\n        attributes {\n          id\n          attribute_id\n        }\n      }\n    }\n  }\n`;\nclass CartModal extends Component {\n  constructor(props) {\n    super(props);\n    this.handlePlaceOrder = createOrder => {\n      const {\n        items,\n        clearCart\n      } = this.context;\n      const orderInput = {\n        total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\n        items: items.map(item => ({\n          product_id: item.id,\n          quantity: item.quantity,\n          price: item.price.amount,\n          attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\n            attribute_id: value\n          })) : []\n        }))\n      };\n      createOrder({\n        variables: {\n          input: orderInput\n        }\n      });\n    };\n    this.openModal = () => {\n      this.setState({\n        isOpen: true\n      });\n    };\n    this.closeModal = () => {\n      this.setState({\n        isOpen: false\n      });\n    };\n    this.state = {\n      isOpen: false\n    };\n    this.modalRef = /*#__PURE__*/React.createRef();\n  }\n  render() {\n    const {\n      isOpen\n    } = this.state;\n    const {\n      items,\n      clearCart\n    } = this.context;\n    if (!isOpen) {\n      return null;\n    }\n    return /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-backdrop\",\n        onClick: this.closeModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        ref: this.modalRef,\n        children: [/*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Query, {\n          query: CREATE_ORDER,\n          children: ({\n            loading,\n            error,\n            data,\n            client\n          }) => {\n            if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: \"Loading...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 35\n            }, this);\n            if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [\"Error: \", error.message]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 33\n            }, this);\n            const {\n              createOrder\n            } = data;\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              id: \"modal-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                disabled: items.length < 1 || loading,\n                className: \"place-order-button\",\n                onClick: () => this.handlePlaceOrder(createOrder),\n                children: loading ? 'Placing order...' : 'Place order'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 84,\n                columnNumber: 19\n              }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"error\",\n                children: [\"Error placing order: \", error.message]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 91,\n                columnNumber: 29\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 17\n            }, this);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true), document.getElementById('modal-root'));\n  }\n}\nCartModal.contextType = CartContext;\nexport default _c2 = /*#__PURE__*/forwardRef(_c = (props, ref) => /*#__PURE__*/_jsxDEV(CartModal, {\n  ...props,\n  forwardedRef: ref\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 105,\n  columnNumber: 43\n}, this));\nvar _c, _c2;\n$RefreshReg$(_c, \"%default%$forwardRef\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","Component","forwardRef","useRef","createPortal","gql","Query","ToastContainer","toast","Cart","CartContext","jsxDEV","_jsxDEV","Fragment","_Fragment","CREATE_ORDER","CartModal","constructor","props","handlePlaceOrder","createOrder","items","clearCart","context","orderInput","total","reduce","acc","item","price","amount","quantity","map","product_id","id","attributes","selectedAttributes","Object","entries","key","value","attribute_id","variables","input","openModal","setState","isOpen","closeModal","state","modalRef","createRef","render","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","query","loading","error","data","client","message","disabled","length","document","getElementById","contextType","_c2","_c","forwardedRef","$RefreshReg$"],"sources":["C:/xampp/htdocs/ecommerce/frontend/src/components/CartModal.js"],"sourcesContent":["import React, { Component, forwardRef, useRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { gql } from '@apollo/client';\r\nimport { Query } from '@apollo/client/react/components';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport Cart from './Cart';\r\nimport { CartContext } from '../store/shopping-cart-context';\r\n\r\nconst CREATE_ORDER = gql`\r\n  mutation CreateOrder($input: OrderInput!) {\r\n    createOrder(input: $input) {\r\n      id\r\n      total\r\n      items {\r\n        id\r\n        product_id\r\n        quantity\r\n        price\r\n        attributes {\r\n          id\r\n          attribute_id\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CartModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isOpen: false,\r\n    };\r\n    this.modalRef = React.createRef();\r\n  }\r\n\r\n  handlePlaceOrder = (createOrder) => {\r\n    const { items, clearCart } = this.context;\r\n    const orderInput = {\r\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\r\n      items: items.map(item => ({\r\n        product_id: item.id,\r\n        quantity: item.quantity,\r\n        price: item.price.amount,\r\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\r\n          attribute_id: value\r\n        })) : [],\r\n      })),\r\n    };\r\n\r\n    createOrder({ variables: { input: orderInput } });\r\n  };\r\n\r\n  openModal = () => {\r\n    this.setState({ isOpen: true });\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ isOpen: false });\r\n  };\r\n\r\n  render() {\r\n    const { isOpen } = this.state;\r\n    const { items, clearCart } = this.context;\r\n\r\n    if (!isOpen) {\r\n      return null;\r\n    }\r\n\r\n    return createPortal(\r\n      <>\r\n        <div className=\"modal-backdrop\" onClick={this.closeModal} />\r\n        <div className=\"modal\" ref={this.modalRef}>\r\n          <Cart />\r\n          <Query query={CREATE_ORDER}>\r\n            {({ loading, error, data, client }) => {\r\n              if (loading) return <div>Loading...</div>;\r\n              if (error) return <div>Error: {error.message}</div>;\r\n\r\n              const { createOrder } = data;\r\n\r\n              return (\r\n                <div id=\"modal-actions\">\r\n                  <button\r\n                    disabled={items.length < 1 || loading}\r\n                    className=\"place-order-button\"\r\n                    onClick={() => this.handlePlaceOrder(createOrder)}\r\n                  >\r\n                    {loading ? 'Placing order...' : 'Place order'}\r\n                  </button>\r\n                  {error && <p className=\"error\">Error placing order: {error.message}</p>}\r\n                </div>\r\n              );\r\n            }}\r\n          </Query>\r\n        </div>\r\n      </>,\r\n      document.getElementById('modal-root')\r\n    );\r\n  }\r\n}\r\n\r\nCartModal.contextType = CartContext;\r\n\r\nexport default forwardRef((props, ref) => <CartModal {...props} forwardedRef={ref} />);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
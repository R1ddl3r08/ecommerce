{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ecommerce\\\\frontend\\\\src\\\\components\\\\CartModal.js\",\n  _s = $RefreshSig$();\nimport React, { Component, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { gql, useMutation } from '@apollo/client';\nimport { ToastContainer, toast } from 'react-toastify';\nimport Cart from './Cart';\nimport { CartContext } from '../store/shopping-cart-context';\nimport { client } from '../ApolloProvider';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CREATE_ORDER = gql`\n  mutation CreateOrder($input: OrderInput!) {\n    createOrder(input: $input) {\n      id\n      total\n      items {\n        id\n        product_id\n        quantity\n        price\n        attributes {\n          id\n          attribute_id\n        }\n      }\n    }\n  }\n`;\nclass CartModal extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isOpen: false,\n      loading: false,\n      error: null\n    };\n    this.modalRef = /*#__PURE__*/React.createRef();\n    this.handlePlaceOrder = this.handlePlaceOrder.bind(this);\n    this.open = this.open.bind(this);\n    this.close = this.close.bind(this);\n  }\n  handlePlaceOrder() {\n    const {\n      items,\n      clearCart\n    } = this.context;\n    const orderInput = {\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\n      items: items.map(item => ({\n        product_id: item.id,\n        quantity: item.quantity,\n        price: item.price.amount,\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\n          attribute_id: value\n        })) : []\n      }))\n    };\n    this.setState({\n      loading: true\n    });\n    this.props.client.mutate({\n      mutation: CREATE_ORDER,\n      variables: {\n        input: orderInput\n      },\n      onCompleted: data => {\n        console.log('Order created:', data);\n        clearCart();\n        this.setState({\n          loading: false,\n          isOpen: false\n        });\n        toast.success(\"Order created!\", {\n          position: \"top-center\",\n          autoClose: 3000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n          progress: undefined\n        });\n      },\n      onError: error => {\n        console.error('Error placing order:', error);\n        this.setState({\n          loading: false,\n          error\n        });\n      }\n    });\n  }\n  open() {\n    this.setState({\n      isOpen: true\n    });\n  }\n  close() {\n    this.setState({\n      isOpen: false\n    });\n  }\n  render() {\n    const {\n      items\n    } = this.context;\n    const {\n      isOpen,\n      loading,\n      error\n    } = this.state;\n    if (!isOpen) {\n      return null;\n    }\n    return /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-backdrop\",\n        onClick: this.close\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        ref: this.modalRef,\n        children: [/*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: items.length < 1 || loading,\n            className: \"place-order-button\",\n            onClick: this.handlePlaceOrder,\n            children: loading ? 'Placing order...' : 'Place order'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error\",\n            children: [\"Error placing order: \", error.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true), document.getElementById('modal-root'));\n  }\n}\nCartModal.contextType = CartContext;\nconst ParentComponent = () => {\n  _s();\n  const modalRef = useRef();\n  const handleOpenModal = () => {\n    modalRef.current.open();\n  };\n  const handleCloseModal = () => {\n    modalRef.current.close();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleOpenModal,\n      children: \"Open Cart Modal\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(CartModal, {\n      ref: modalRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 135,\n    columnNumber: 5\n  }, this);\n};\n_s(ParentComponent, \"zNVem5B1U/BPM1VF05fbpVyTiCs=\");\n_c = ParentComponent;\nexport default ParentComponent;\nvar _c;\n$RefreshReg$(_c, \"ParentComponent\");","map":{"version":3,"names":["React","Component","useRef","createPortal","gql","useMutation","ToastContainer","toast","Cart","CartContext","client","jsxDEV","_jsxDEV","Fragment","_Fragment","CREATE_ORDER","CartModal","constructor","props","state","isOpen","loading","error","modalRef","createRef","handlePlaceOrder","bind","open","close","items","clearCart","context","orderInput","total","reduce","acc","item","price","amount","quantity","map","product_id","id","attributes","selectedAttributes","Object","entries","key","value","attribute_id","setState","mutate","mutation","variables","input","onCompleted","data","console","log","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","onError","render","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","disabled","length","message","document","getElementById","contextType","ParentComponent","_s","handleOpenModal","current","handleCloseModal","_c","$RefreshReg$"],"sources":["C:/xampp/htdocs/ecommerce/frontend/src/components/CartModal.js"],"sourcesContent":["import React, { Component, useRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { gql, useMutation } from '@apollo/client';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\nimport Cart from './Cart';\r\nimport { CartContext } from '../store/shopping-cart-context';\r\nimport { client } from '../ApolloProvider';\r\n\r\nconst CREATE_ORDER = gql`\r\n  mutation CreateOrder($input: OrderInput!) {\r\n    createOrder(input: $input) {\r\n      id\r\n      total\r\n      items {\r\n        id\r\n        product_id\r\n        quantity\r\n        price\r\n        attributes {\r\n          id\r\n          attribute_id\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CartModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isOpen: false,\r\n      loading: false,\r\n      error: null,\r\n    };\r\n    this.modalRef = React.createRef();\r\n    this.handlePlaceOrder = this.handlePlaceOrder.bind(this);\r\n    this.open = this.open.bind(this);\r\n    this.close = this.close.bind(this);\r\n  }\r\n\r\n  static contextType = CartContext;\r\n\r\n  handlePlaceOrder() {\r\n    const { items, clearCart } = this.context;\r\n\r\n    const orderInput = {\r\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\r\n      items: items.map(item => ({\r\n        product_id: item.id,\r\n        quantity: item.quantity,\r\n        price: item.price.amount,\r\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\r\n          attribute_id: value\r\n        })) : [],\r\n      })),\r\n    };\r\n\r\n    this.setState({ loading: true });\r\n  \r\n    this.props.client.mutate({\r\n      mutation: CREATE_ORDER,\r\n      variables: { input: orderInput },\r\n      onCompleted: (data) => {\r\n        console.log('Order created:', data);\r\n        clearCart();\r\n        this.setState({ loading: false, isOpen: false });\r\n        toast.success(\"Order created!\", {\r\n          position: \"top-center\",\r\n          autoClose: 3000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n        });\r\n      },\r\n      onError: (error) => {\r\n        console.error('Error placing order:', error);\r\n        this.setState({ loading: false, error });\r\n      }\r\n    });\r\n  }\r\n\r\n  open() {\r\n    this.setState({ isOpen: true });\r\n  }\r\n\r\n  close() {\r\n    this.setState({ isOpen: false });\r\n  }\r\n\r\n  render() {\r\n    const { items } = this.context;\r\n    const { isOpen, loading, error } = this.state;\r\n\r\n    if (!isOpen) {\r\n      return null;\r\n    }\r\n\r\n    return createPortal(\r\n      <>\r\n        <div className=\"modal-backdrop\" onClick={this.close} />\r\n        <div className=\"modal\" ref={this.modalRef}>\r\n          <Cart />\r\n          <div id=\"modal-actions\">\r\n            <button\r\n              disabled={items.length < 1 || loading}\r\n              className=\"place-order-button\"\r\n              onClick={this.handlePlaceOrder}\r\n            >\r\n              {loading ? 'Placing order...' : 'Place order'}\r\n            </button>\r\n            {error && <p className=\"error\">Error placing order: {error.message}</p>}\r\n          </div>\r\n        </div>\r\n      </>,\r\n      document.getElementById('modal-root')\r\n    );\r\n  }\r\n}\r\n\r\nconst ParentComponent = () => {\r\n  const modalRef = useRef();\r\n\r\n  const handleOpenModal = () => {\r\n    modalRef.current.open();\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    modalRef.current.close();\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      {/* Your UI components */}\r\n      <button onClick={handleOpenModal}>Open Cart Modal</button>\r\n      {/* Other UI components */}\r\n      <CartModal ref={modalRef} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ParentComponent;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ecommerce\\\\frontend\\\\src\\\\components\\\\CartModal.js\";\nimport React, { forwardRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport Cart from './Cart';\nimport { CartContext } from '../store/shopping-cart-context';\nimport { gql, useMutation } from '@apollo/client';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst CREATE_ORDER = gql`\n  mutation CreateOrder($input: OrderInput!) {\n    createOrder(input: $input) {\n      id\n      total\n      items {\n        id\n        product_id\n        quantity\n        price\n        attributes {\n          id\n          attribute_id\n        }\n      }\n    }\n  }\n`;\nclass CartModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.createOrder = () => {\n      const {\n        items,\n        clearCart\n      } = this.context;\n      const orderInput = {\n        total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\n        items: items.map(item => ({\n          product_id: item.id,\n          quantity: item.quantity,\n          price: item.price.amount,\n          attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\n            attribute_id: value\n          })) : []\n        }))\n      };\n      this.props.createOrder({\n        variables: {\n          input: orderInput\n        }\n      });\n    };\n    this.handlePlaceOrder = () => {\n      const {\n        clearCart\n      } = this.context;\n      this.createOrder();\n      clearCart();\n      this.setState({\n        isOpen: false\n      });\n      toast.success(\"Order created!\", {\n        position: \"top-center\",\n        autoClose: 3000,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined\n      });\n    };\n    this.openModal = () => {\n      this.setState({\n        isOpen: true\n      });\n    };\n    this.closeModal = () => {\n      this.setState({\n        isOpen: false\n      });\n    };\n    this.modalRef = /*#__PURE__*/React.createRef();\n    this.state = {\n      isOpen: false\n    };\n  }\n  render() {\n    const {\n      isOpen\n    } = this.state;\n    const {\n      items,\n      loading,\n      error\n    } = this.props;\n    if (!isOpen) {\n      return null;\n    }\n    return /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal-backdrop\",\n        onClick: this.closeModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modal\",\n        ref: this.modalRef,\n        children: [/*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"modal-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: items.length < 1 || loading,\n            className: \"place-order-button\",\n            onClick: this.handlePlaceOrder,\n            children: loading ? 'Placing order...' : 'Place order'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this), error && /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"error\",\n            children: [\"Error placing order: \", error.message]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true), document.getElementById('modal-root'));\n  }\n}\nCartModal.contextType = CartContext;\nexport default _c2 = /*#__PURE__*/forwardRef(_c = (props, ref) => /*#__PURE__*/_jsxDEV(CartModal, {\n  ...props,\n  forwardedRef: ref\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 109,\n  columnNumber: 43\n}, this));\nvar _c, _c2;\n$RefreshReg$(_c, \"%default%$forwardRef\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","forwardRef","createPortal","Cart","CartContext","gql","useMutation","toast","jsxDEV","_jsxDEV","Fragment","_Fragment","CREATE_ORDER","CartModal","Component","constructor","props","createOrder","items","clearCart","context","orderInput","total","reduce","acc","item","price","amount","quantity","map","product_id","id","attributes","selectedAttributes","Object","entries","key","value","attribute_id","variables","input","handlePlaceOrder","setState","isOpen","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","openModal","closeModal","modalRef","createRef","state","render","loading","error","children","className","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","disabled","length","message","document","getElementById","contextType","_c2","_c","forwardedRef","$RefreshReg$"],"sources":["C:/xampp/htdocs/ecommerce/frontend/src/components/CartModal.js"],"sourcesContent":["import React, { forwardRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport Cart from './Cart';\r\nimport { CartContext } from '../store/shopping-cart-context';\r\nimport { gql, useMutation } from '@apollo/client';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst CREATE_ORDER = gql`\r\n  mutation CreateOrder($input: OrderInput!) {\r\n    createOrder(input: $input) {\r\n      id\r\n      total\r\n      items {\r\n        id\r\n        product_id\r\n        quantity\r\n        price\r\n        attributes {\r\n          id\r\n          attribute_id\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nclass CartModal extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.modalRef = React.createRef();\r\n    this.state = {\r\n      isOpen: false,\r\n    };\r\n  }\r\n\r\n  static contextType = CartContext;\r\n\r\n  createOrder = () => {\r\n    const { items, clearCart } = this.context;\r\n    const orderInput = {\r\n      total: items.reduce((acc, item) => acc + item.price.amount * item.quantity, 0),\r\n      items: items.map(item => ({\r\n        product_id: item.id,\r\n        quantity: item.quantity,\r\n        price: item.price.amount,\r\n        attributes: item.selectedAttributes ? Object.entries(item.selectedAttributes).map(([key, value]) => ({\r\n          attribute_id: value\r\n        })) : [],\r\n      })),\r\n    };\r\n  \r\n    this.props.createOrder({ variables: { input: orderInput } });\r\n  };\r\n\r\n  handlePlaceOrder = () => {\r\n    const { clearCart } = this.context;\r\n    this.createOrder();\r\n    clearCart();\r\n    this.setState({ isOpen: false });\r\n    toast.success(\"Order created!\", {\r\n      position: \"top-center\",\r\n      autoClose: 3000,\r\n      hideProgressBar: false,\r\n      closeOnClick: true,\r\n      pauseOnHover: true,\r\n      draggable: true,\r\n      progress: undefined,\r\n    });\r\n  };\r\n\r\n  openModal = () => {\r\n    this.setState({ isOpen: true });\r\n  };\r\n\r\n  closeModal = () => {\r\n    this.setState({ isOpen: false });\r\n  };\r\n\r\n  render() {\r\n    const { isOpen } = this.state;\r\n    const { items, loading, error } = this.props;\r\n\r\n    if (!isOpen) {\r\n      return null;\r\n    }\r\n\r\n    return createPortal(\r\n      <>\r\n        <div className=\"modal-backdrop\" onClick={this.closeModal} />\r\n        <div className=\"modal\" ref={this.modalRef}>\r\n          <Cart />\r\n          <div id=\"modal-actions\">\r\n            <button\r\n              disabled={items.length < 1 || loading}\r\n              className=\"place-order-button\"\r\n              onClick={this.handlePlaceOrder}\r\n            >\r\n              {loading ? 'Placing order...' : 'Place order'}\r\n            </button>\r\n            {error && <p className=\"error\">Error placing order: {error.message}</p>}\r\n          </div>\r\n        </div>\r\n      </>,\r\n      document.getElementById('modal-root')\r\n    );\r\n  }\r\n}\r\n\r\nexport default forwardRef((props, ref) => <CartModal {...props} forwardedRef={ref} />);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}